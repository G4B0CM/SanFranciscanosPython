{% extends 'base.html' %}
{% from "_form_helpers.html" import render_field %}
{% block title %}{{ title }}{% endblock %}

{% block head_extra %}
{# El CSS de la barra de progreso se mantiene #}
<style>
    .progress-container {
        margin-bottom: 2rem;
    }

    .progress-step {
        width: 25%;
        text-align: center;
        position: relative;
        font-weight: 600;
        color: #ccc;
        transition: color 0.4s ease;
    }

    .progress-step.active {
        color: var(--dark-gold);
    }

    .progress-step.completed {
        color: var(--darker-gold);
    }

    .progress-step::before {
        content: '';
        position: absolute;
        top: 50%;
        left: -50%;
        width: 100%;
        height: 3px;
        background-color: #e0e0e0;
        z-index: -1;
        transform: translateY(-50%);
    }

    .progress-step:first-child::before {
        content: none;
    }

    .progress-step .step-circle {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background-color: #e0e0e0;
        border: 3px solid #e0e0e0;
        margin: 0 auto 10px;
        line-height: 24px;
        font-weight: bold;
        color: white;
        transition: all 0.4s ease;
    }

    .progress-step.active .step-circle {
        background-color: white;
        border-color: var(--primary-color);
        color: var(--dark-gold);
    }

    .progress-step.completed .step-circle {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
        color: white;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center mb-4">{{ title }}</h1>

    <!-- Barra de Progreso Visual -->
    <div class="d-flex progress-container">
        <div class="progress-step completed">
            <div class="step-circle"><i class="fas fa-check"></i></div>Ficha de Datos
        </div>
        <div class="progress-step completed">
            <div class="step-circle"><i class="fas fa-check"></i></div>Fe de Bautismo
        </div>
        <div class="progress-step completed">
            <div class="step-circle"><i class="fas fa-check"></i></div>Pago
        </div>
        <div class="progress-step active">
            <div class="step-circle">4</div>Inscripción a Curso
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-body p-4 text-center">
            {# ---#-!-# FORMULARIO HTML TRADICIONAL --- #}
            <form method="POST" action="{{ url_for('Onboarding.process_enrollment', catequizado_id=catequizado_id) }}"
                novalidate>
                {{ form.hidden_tag() }} {# Esto incluye el CSRF token #}
                <p class="lead">Seleccione el curso al que desea inscribir al catequizado.</p>
                <div class="mb-3">
                    {# Usamos el EnrollmentForm para renderizar el campo idCurso #}
                    {{ render_field(form.idCurso, class='form-select') }}
                </div>
                {# El campo 'catequizados' no se usa aquí, así que lo ignoramos #}
                <button type="submit" class="btn btn-success btn-lg"><i class="fas fa-check-circle me-2"></i>Finalizar
                    Inscripción</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}